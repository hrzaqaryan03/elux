import React, { useEffect, useState } from "react";
import style from "../header/header.module.scss";
import { Link } from "react-router-dom";
import HeaderTop from "./HeaderTop";
import { useSelector } from "react-redux";
import Button from "@mui/material/Button";
import Drawer from "../drawer/Drawer";
import Userprofile from "../userProfile/Userprofile";

const Header = () => {
  const user = useSelector((state) => state.auth.user);
  const [isActiveBurger, setIsActiveBurger] = useState(
    window.innerWidth <= 768
  );
  const [isDrawerOpen, setIsDrawerOpen] = useState(false);
  const [isProfileOpen , setIsProfileOpen] = useState(false)
  useEffect(() => {
    const handleResize = () => {
      setIsActiveBurger(window.innerWidth < 768);
    };
    window.addEventListener("resize", handleResize);
    return () => window.removeEventListener("resize", handleResize);
  }, []);

  const toggleDrawer = () => setIsDrawerOpen(!isDrawerOpen);

  return (
    <header className={style.header}>
      {!isActiveBurger && <HeaderTop />}
      <div className={style.container}>
        <div className={style.header_body}>
          <div className={style.header_body__container}>
            {isActiveBurger ? (
              <Button onClick={toggleDrawer}>
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M2 5.99519C2 5.44556 2.44556 5 2.99519 5H11.0048C11.5544 5 12 5.44556 12 5.99519C12 6.54482 11.5544 6.99039 11.0048 6.99039H2.99519C2.44556 6.99039 2 6.54482 2 5.99519Z"
                    fill="black"
                  />
                  <path
                    d="M2 11.9998C2 11.4501 2.44556 11.0046 2.99519 11.0046H21.0048C21.5544 11.0046 22 11.4501 22 11.9998C22 12.5494 21.5544 12.9949 21.0048 12.9949H2.99519C2.44556 12.9949 2 12.5494 2 11.9998Z"
                    fill="black"
                  />
                  <path
                    d="M2.99519 17.0095C2.44556 17.0095 2 17.4551 2 18.0047C2 18.5543 2.44556 18.9999 2.99519 18.9999H15.0048C15.5544 18.9999 16 18.5543 16 18.0047C16 17.4551 15.5544 17.0095 15.0048 17.0095H2.99519Z"
                    fill="black"
                  />
                </svg>
              </Button>
            ) : (
              <ul>
                <li>
                  <Link to="/services">
                    <span>Services</span>
                    <span className={style.line}></span>
                  </Link>
                </li>
                <li>
                  <Link to="/experts">
                    <span>Experts</span>
                    <span className={style.line}></span>
                  </Link>
                </li>
                <li>
                  <Link to="/about">
                    <span>About</span>
                    <span className={style.line}></span>
                  </Link>
                </li>
                <li>
                  <Link to="/blog">
                    <span>Blog</span>
                    <span className={style.line}></span>
                  </Link>
                </li>
                <li>
                  <Link to="/contact">
                    <span>Contact</span>
                    <span className={style.line}></span>
                  </Link>
                </li>
              </ul>
            )}
            <div className={style.logo}>
              <Link to="/">
                <span>
                  <svg
                    width="95"
                    height="52"
                    viewBox="0 0 95 52"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M8.608 14.076L2.816 9.468H8.192L12.512 14.076H8.608Z"
                      fill="#292929"
                    />
                    <path
                      d="M12.42 35.824C10.116 35.824 8.1 35.392 6.372 34.528C4.668 33.64 3.336 32.44 2.376 30.928C1.44 29.392 0.972 27.652 0.972 25.708C0.972 23.764 1.428 22.036 2.34 20.524C3.276 18.988 4.56 17.8 6.192 16.96C7.824 16.096 9.66 15.664 11.7 15.664C13.62 15.664 15.372 16.06 16.956 16.852C18.54 17.62 19.8 18.76 20.736 20.272C21.672 21.784 22.14 23.62 22.14 25.78C22.14 26.02 22.128 26.296 22.104 26.608C22.08 26.92 22.056 27.208 22.032 27.472H6.588V23.872H18.396L15.804 24.88C15.828 23.992 15.66 23.224 15.3 22.576C14.964 21.928 14.484 21.424 13.86 21.064C13.26 20.704 12.552 20.524 11.736 20.524C10.92 20.524 10.2 20.704 9.576 21.064C8.976 21.424 8.508 21.94 8.172 22.612C7.836 23.26 7.668 24.028 7.668 24.916V25.96C7.668 26.92 7.86 27.748 8.244 28.444C8.652 29.14 9.228 29.68 9.972 30.064C10.716 30.424 11.604 30.604 12.636 30.604C13.596 30.604 14.412 30.472 15.084 30.208C15.78 29.92 16.464 29.488 17.136 28.912L20.736 32.656C19.8 33.688 18.648 34.48 17.28 35.032C15.912 35.56 14.292 35.824 12.42 35.824ZM29.6137 35.5V8.788H36.4537V35.5H29.6137ZM53.4268 35.824C51.8428 35.824 50.4148 35.512 49.1428 34.888C47.8948 34.264 46.9108 33.292 46.1908 31.972C45.4948 30.628 45.1468 28.936 45.1468 26.896V15.988H51.9868V25.78C51.9868 27.292 52.2628 28.372 52.8148 29.02C53.3908 29.668 54.1948 29.992 55.2268 29.992C55.8988 29.992 56.5108 29.836 57.0628 29.524C57.6148 29.212 58.0588 28.72 58.3948 28.048C58.7308 27.352 58.8988 26.464 58.8988 25.384V15.988H65.7388V35.5H59.2228V29.992L60.4828 31.54C59.8108 32.98 58.8388 34.06 57.5668 34.78C56.2948 35.476 54.9148 35.824 53.4268 35.824ZM72.1966 35.5L81.1606 23.728L81.0166 27.616L72.4126 15.988H80.1166L84.9406 22.864L82.0606 23.008L87.1726 15.988H94.4086L85.8046 27.364V23.62L94.6606 35.5H86.8486L81.8086 28.156L84.6886 28.552L79.6126 35.5H72.1966Z"
                      fill="#292929"
                    />
                    <path
                      d="M14.254 48.5V40.8H17.576C18.434 40.8 19.0977 40.9723 19.567 41.317C20.0437 41.6617 20.282 42.1493 20.282 42.78C20.282 43.198 20.183 43.55 19.985 43.836C19.7943 44.122 19.5303 44.3383 19.193 44.485C18.863 44.6317 18.5 44.705 18.104 44.705L18.291 44.441C18.7823 44.441 19.204 44.518 19.556 44.672C19.9153 44.8187 20.194 45.0423 20.392 45.343C20.59 45.6363 20.689 46.003 20.689 46.443C20.689 47.0957 20.447 47.6017 19.963 47.961C19.4863 48.3203 18.764 48.5 17.796 48.5H14.254ZM15.068 47.829H17.785C18.4597 47.829 18.9767 47.7153 19.336 47.488C19.6953 47.2533 19.875 46.883 19.875 46.377C19.875 45.8783 19.6953 45.5153 19.336 45.288C18.9767 45.0533 18.4597 44.936 17.785 44.936H14.98V44.265H17.521C18.137 44.265 18.6137 44.1477 18.951 43.913C19.2957 43.6783 19.468 43.33 19.468 42.868C19.468 42.3987 19.2957 42.0503 18.951 41.823C18.6137 41.5883 18.137 41.471 17.521 41.471H15.068V47.829ZM27.893 44.243H31.963V44.936H27.893V44.243ZM27.981 47.796H32.612V48.5H27.167V40.8H32.447V41.504H27.981V47.796ZM37.9134 48.5L41.4334 40.8H42.2364L45.7564 48.5H44.8984L41.6644 41.273H41.9944L38.7604 48.5H37.9134ZM39.2994 46.443L39.5414 45.783H44.0184L44.2604 46.443H39.2994ZM54.591 48.566C53.6083 48.566 52.8347 48.2837 52.27 47.719C51.7053 47.1543 51.423 46.3183 51.423 45.211V40.8H52.237V45.178C52.237 46.0873 52.4423 46.7583 52.853 47.191C53.2637 47.6237 53.843 47.84 54.591 47.84C55.3463 47.84 55.9293 47.6237 56.34 47.191C56.7507 46.7583 56.956 46.0873 56.956 45.178V40.8H57.748V45.211C57.748 46.3183 57.4657 47.1543 56.901 47.719C56.3437 48.2837 55.5737 48.566 54.591 48.566ZM66.1665 48.5V41.504H63.4605V40.8H69.6865V41.504H66.9805V48.5H66.1665ZM77.3902 48.5V45.64L77.5772 46.146L74.3102 40.8H75.1792L78.0502 45.497H77.5882L80.4592 40.8H81.2732L78.0062 46.146L78.1932 45.64V48.5H77.3902Z"
                      fill="#292929"
                    />
                  </svg>
                </span>
              </Link>
            </div>
            <div className={style.auth_box}>
              {user ? (
                <div className={style .userBox}>
                  <span className={style.user_name}>Hi, Ann</span>
                  <button onClick={() => setIsProfileOpen((prev) => !prev)}>
                    <svg
                      width="28"
                      height="28"
                      viewBox="0 0 28 28"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M0 13.9998C0.000359232 6.26764 6.26788 -0.000244141 14 -0.000244141C21.7321 -0.000244141 28.0004 6.26764 28.0004 13.9998C28.0004 21.7319 21.7325 27.9994 14 28.0001C6.26788 27.9994 0.000359232 21.7319 0 13.9998ZM4.35785 4.3576C1.89028 6.82589 0.363902 10.2336 0.363902 13.9998C0.363902 17.7663 1.89028 21.174 4.35785 23.6423C6.82613 26.1098 10.2338 27.6359 14 27.6359C17.7662 27.6359 21.1742 26.1098 23.6425 23.6423C26.1108 21.174 27.6365 17.7663 27.6365 13.9998C27.6365 10.2339 26.1108 6.82589 23.6425 4.3576C21.1739 1.88968 17.7662 0.363658 14 0.363658C10.2338 0.363658 6.82613 1.88968 4.35785 4.3576Z"
                        fill="#292929"
                      />
                      <path
                        d="M10.1309 9.63627C10.1309 7.49991 11.8627 5.76769 13.9998 5.76733C16.1361 5.76769 17.8684 7.49955 17.8684 9.63627C17.8684 11.773 16.1365 13.5052 13.9998 13.5056C11.8627 13.5052 10.1309 11.773 10.1309 9.63627ZM10.5152 9.63627C10.5188 11.5603 12.0754 13.1165 13.9994 13.1205C15.9231 13.1165 17.4797 11.5603 17.4833 9.63627C17.4797 7.71222 15.9231 6.15602 13.9994 6.15279C12.0754 6.15602 10.5188 7.71222 10.5152 9.63627Z"
                        fill="#292929"
                      />
                      <path
                        d="M6.50195 20.9592L6.5271 20.7559C7.02607 16.6732 10.1694 13.5073 14.0009 13.5051C17.8329 13.5073 20.9765 16.6732 21.4751 20.7559L21.4999 20.9592H6.50195ZM21.0864 20.5957C20.5264 16.7691 17.5573 13.8662 14.0006 13.8683C10.4449 13.8662 7.47475 16.7691 6.91507 20.5957H21.0864Z"
                        fill="#292929"
                      />
                    </svg>
                  </button>
                </div>
              ) : (
                <div>
                  <Link to={"/login"}>Login   /</Link>
                  <Link to={"/login"}> sign up</Link>
                </div>
              )}
            </div>
          </div>
        </div>
      </div>
      {isActiveBurger && (
        <Drawer isOpen={isDrawerOpen} onClose={toggleDrawer} />
      )}
      {isProfileOpen && <Userprofile active={isProfileOpen} disable={setIsProfileOpen}/>}
    </header>
  );
};

export default Header;
